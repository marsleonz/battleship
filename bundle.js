(()=>{var t={246:t=>{t.exports={createPlayer:function(t){return{attack:function(r){t.receiveAttack(r)}}},createComputer:function(t){var r=[];return{attack:function(n){if(n){if(r.some((function(t){return t[0]===n[0]&&t[1]===n[1]})))return}else n=function(){var t,n;do{t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random())}while(r.some((function(r){return r[0]===t&&r[1]===n})));return[t,n]}(),r.push(n);return t.receiveAttack(n),n}}}}}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}(()=>{"use strict";function t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var e,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(e=i.call(n)).done)&&(c.push(e.value),c.length!==r);l=!0);}catch(t){u=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(t,n){if(t){if("string"==typeof t)return r(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}const e=function(r){var n=Array.from({length:10},(function(){return Array(10).fill(null)})),e=[],o=[],i=function(r,e,i){var a=t(e,2),c=a[0],l=a[1],u=r.length;if(!(c<0||c>=10||l<0||l>=10||"horizontal"===i&&l+u>10||"vertical"===i&&c+u>10)){if("horizontal"===i){for(var s=0;s<u;s++)if(null!==n[c][l+s])return;for(var f=0;f<u;f++)n[c][l+f]=r}else{for(var h=0;h<u;h++)if(null!==n[c+h][l])return;for(var d=0;d<u;d++)n[c+d][l]=r}o.push(r)}};return r.forEach((function(t){var r=t.ship,n=t.coords,e=t.orientation;i(r,n,e)})),{board:n,placeShip:i,missedAttacks:e,receiveAttack:function(r){var o=t(r,2),i=o[0],a=o[1],c=n[i][a];c?c.hit():e.push(r)},allSunk:function(){return o.every((function(t){return t.isSunk()}))}}};var o=n(246);const i=function(t){return{length:t,hits:0,hit:function(){this.hits++},isSunk:function(){return this.hits===this.length}}};function a(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}var c=[{ship:i(5),coords:[0,0],orientation:"horizontal"},{ship:i(4),coords:[2,3],orientation:"vertical"},{ship:i(3),coords:[7,4],orientation:"horizontal"},{ship:i(3),coords:[4,1],orientation:"vertical"},{ship:i(2),coords:[6,6],orientation:"horizontal"}],l=[{ship:i(5),coords:[0,0],orientation:"horizontal"},{ship:i(4),coords:[2,3],orientation:"vertical"},{ship:i(3),coords:[6,6],orientation:"horizontal"},{ship:i(3),coords:[8,1],orientation:"horizontal"},{ship:i(2),coords:[7,4],orientation:"horizontal"}],u=e(c),s=e(l),f=(0,o.createPlayer)(s),h=(0,o.createComputer)(u),d=document.getElementById("player-board"),p=document.getElementById("computer-board"),v=function t(r,n){n.innerHTML="",r.board.forEach((function(e,o){e.forEach((function(e,i){var a=document.createElement("div");a.classList.add("cell"),e&&a.classList.add("ship"),a.addEventListener("click",(function(){r===s&&(f.attack([o,i]),t(s,p),s.allSunk()?alert("You win!"):y())})),n.appendChild(a)}))})),r.missedAttacks.forEach((function(t){var r,e,o=(e=2,function(t){if(Array.isArray(t))return t}(r=t)||function(t,r){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var e,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===r){if(Object(n)!==n)return;l=!1}else for(;!(l=(e=i.call(n)).done)&&(c.push(e.value),c.length!==r);l=!0);}catch(t){u=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(r,e)||function(t,r){if(t){if("string"==typeof t)return a(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,r):void 0}}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],c=o[1];n.children[10*i+c].classList.add("missed")}))},y=function(){h.attack(),v(u,d),u.allSunk()&&alert("Computer wins!")};v(u,d),v(s,p)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJxQkFzQ0FBLEVBQU9DLFFBQVUsQ0FBRUMsYUF0Q0UsU0FBQ0MsR0FLcEIsTUFBTyxDQUFFQyxPQUpNLFNBQUNDLEdBQ2RGLEVBQWVHLGNBQWNELEVBQy9CLEVBR0YsRUFnQ2lDRSxlQTlCVixTQUFDQyxHQUN0QixJQUFNQyxFQUFpQixHQTBCdkIsTUFBTyxDQUFFTCxPQWJNLFNBQUNDLEdBQ2QsR0FBS0EsR0FHRSxHQUNMSSxFQUFlQyxNQUFLLFNBQUNDLEdBQUMsT0FBS0EsRUFBRSxLQUFPTixFQUFPLElBQU1NLEVBQUUsS0FBT04sRUFBTyxFQUFFLElBRW5FLFlBTEFBLEVBYm9CLFdBQ3RCLElBQUlPLEVBQUtDLEVBQ1QsR0FDRUQsRUFBTUUsS0FBS0MsTUFBc0IsR0FBaEJELEtBQUtFLFVBQ3RCSCxFQUFNQyxLQUFLQyxNQUFzQixHQUFoQkQsS0FBS0UsZ0JBRXRCUCxFQUFlQyxNQUFLLFNBQUNMLEdBQU0sT0FBS0EsRUFBTyxLQUFPTyxHQUFPUCxFQUFPLEtBQU9RLENBQUcsS0FFeEUsTUFBTyxDQUFDRCxFQUFLQyxFQUNmLENBSWFJLEdBQ1RSLEVBQWVTLEtBQUtiLEdBT3RCLE9BREFHLEVBQWdCRixjQUFjRCxHQUN2QkEsQ0FDVCxFQUdGLEUsR0NuQ0ljLEVBQTJCLENBQUMsRUFHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQkUsSUFBakJELEVBQ0gsT0FBT0EsRUFBYXJCLFFBR3JCLElBQUlELEVBQVNtQixFQUF5QkUsR0FBWSxDQUdqRHBCLFFBQVMsQ0FBQyxHQU9YLE9BSEF1QixFQUFvQkgsR0FBVXJCLEVBQVFBLEVBQU9DLFFBQVNtQixHQUcvQ3BCLEVBQU9DLE9BQ2YsQyxxaUNDNENBLFFBbEV3QixTQUFDd0IsR0FDdkIsSUFBTUMsRUFBUUMsTUFBTUMsS0FBSyxDQUFFQyxPQUFRLEtBQU0sa0JBQU1GLE1BQU0sSUFBSUcsS0FBSyxLQUFLLElBQzdEQyxFQUFnQixHQUNoQkMsRUFBUSxHQUVSQyxFQUFZLFNBQUNDLEVBQU03QixFQUFROEIsR0FDL0IsSUFBQUMsRUFBQUMsRUFBbUJoQyxFQUFNLEdBQWxCTyxFQUFHd0IsRUFBQSxHQUFFdkIsRUFBR3VCLEVBQUEsR0FDVFAsRUFBU0ssRUFBS0wsT0FFcEIsS0FDRWpCLEVBQU0sR0FDTkEsR0FBTyxJQUNQQyxFQUFNLEdBQ05BLEdBQU8sSUFDVSxlQUFoQnNCLEdBQWdDdEIsRUFBTWdCLEVBQVMsSUFDL0IsYUFBaEJNLEdBQThCdkIsRUFBTWlCLEVBQVMsSUFOaEQsQ0FZQSxHQUFvQixlQUFoQk0sRUFBOEIsQ0FDaEMsSUFBSyxJQUFJRyxFQUFJLEVBQUdBLEVBQUlULEVBQVFTLElBQzFCLEdBQTRCLE9BQXhCWixFQUFNZCxHQUFLQyxFQUFNeUIsR0FFbkIsT0FHSixJQUFLLElBQUlBLEVBQUksRUFBR0EsRUFBSVQsRUFBUVMsSUFDMUJaLEVBQU1kLEdBQUtDLEVBQU15QixHQUFLSixDQUUxQixLQUFPLENBQ0wsSUFBSyxJQUFJSSxFQUFJLEVBQUdBLEVBQUlULEVBQVFTLElBQzFCLEdBQTRCLE9BQXhCWixFQUFNZCxFQUFNMEIsR0FBR3pCLEdBRWpCLE9BR0osSUFBSyxJQUFJeUIsRUFBSSxFQUFHQSxFQUFJVCxFQUFRUyxJQUMxQlosRUFBTWQsRUFBTTBCLEdBQUd6QixHQUFPcUIsQ0FFMUIsQ0FDQUYsRUFBTWQsS0FBS2dCLEVBdkJYLENBd0JGLEVBb0JBLE9BbEJBVCxFQUFZYyxTQUFRLFNBQUFDLEdBQW1DLElBQWhDTixFQUFJTSxFQUFKTixLQUFNN0IsRUFBTW1DLEVBQU5uQyxPQUFROEIsRUFBV0ssRUFBWEwsWUFDbkNGLEVBQVVDLEVBQU03QixFQUFROEIsRUFDMUIsSUFnQk8sQ0FBRVQsTUFBQUEsRUFBT08sVUFBQUEsRUFBV0YsY0FBQUEsRUFBZXpCLGNBZnBCLFNBQUNELEdBQ3JCLElBQUFvQyxFQUFBSixFQUFtQmhDLEVBQU0sR0FBbEJPLEVBQUc2QixFQUFBLEdBQUU1QixFQUFHNEIsRUFBQSxHQUNUUCxFQUFPUixFQUFNZCxHQUFLQyxHQUVwQnFCLEVBQ0ZBLEVBQUtRLE1BRUxYLEVBQWNiLEtBQUtiLEVBRXZCLEVBTXlEc0MsUUFKekMsV0FDZCxPQUFPWCxFQUFNWSxPQUFNLFNBQUNWLEdBQUksT0FBS0EsRUFBS1csUUFBUSxHQUM1QyxFQUdGLEUsYUNwREEsUUFaQSxTQUFvQmhCLEdBQ2xCLE1BQU8sQ0FDTEEsT0FBQUEsRUFDQWlCLEtBQU0sRUFDTkosSUFBRyxXQUNESyxLQUFLRCxNQUNQLEVBQ0FELE9BQU0sV0FDSixPQUFPRSxLQUFLRCxPQUFTQyxLQUFLbEIsTUFDNUIsRUFFSixFLDBHQ1BBLElBQU1tQixFQUFvQixDQUN4QixDQUFFZCxLQUFNZSxFQUFXLEdBQUk1QyxPQUFRLENBQUMsRUFBRyxHQUFJOEIsWUFBYSxjQUNwRCxDQUFFRCxLQUFNZSxFQUFXLEdBQUk1QyxPQUFRLENBQUMsRUFBRyxHQUFJOEIsWUFBYSxZQUNwRCxDQUFFRCxLQUFNZSxFQUFXLEdBQUk1QyxPQUFRLENBQUMsRUFBRyxHQUFJOEIsWUFBYSxjQUNwRCxDQUFFRCxLQUFNZSxFQUFXLEdBQUk1QyxPQUFRLENBQUMsRUFBRyxHQUFJOEIsWUFBYSxZQUNwRCxDQUFFRCxLQUFNZSxFQUFXLEdBQUk1QyxPQUFRLENBQUMsRUFBRyxHQUFJOEIsWUFBYSxlQUdoRGUsRUFBc0IsQ0FDMUIsQ0FBRWhCLEtBQU1lLEVBQVcsR0FBSTVDLE9BQVEsQ0FBQyxFQUFHLEdBQUk4QixZQUFhLGNBQ3BELENBQUVELEtBQU1lLEVBQVcsR0FBSTVDLE9BQVEsQ0FBQyxFQUFHLEdBQUk4QixZQUFhLFlBQ3BELENBQUVELEtBQU1lLEVBQVcsR0FBSTVDLE9BQVEsQ0FBQyxFQUFHLEdBQUk4QixZQUFhLGNBQ3BELENBQUVELEtBQU1lLEVBQVcsR0FBSTVDLE9BQVEsQ0FBQyxFQUFHLEdBQUk4QixZQUFhLGNBQ3BELENBQUVELEtBQU1lLEVBQVcsR0FBSTVDLE9BQVEsQ0FBQyxFQUFHLEdBQUk4QixZQUFhLGVBSWhEM0IsRUFBa0IyQyxFQUFnQkgsR0FDbENJLEVBQW9CRCxFQUFnQkQsR0FDcENHLEdBQVNuRCxFQUFBQSxFQUFBQSxjQUFha0QsR0FDdEJFLEdBQVcvQyxFQUFBQSxFQUFBQSxnQkFBZUMsR0FFMUIrQyxFQUFjQyxTQUFTQyxlQUFlLGdCQUN0Q0MsRUFBZ0JGLFNBQVNDLGVBQWUsa0JBRXhDRSxFQUFrQixTQUFsQkEsRUFBbUJDLEVBQVdDLEdBRWxDQSxFQUFhQyxVQUFZLEdBR3pCRixFQUFVbEMsTUFBTWEsU0FBUSxTQUFDM0IsRUFBS21ELEdBQzVCbkQsRUFBSTJCLFNBQVEsU0FBQ3lCLEVBQU1DLEdBQ2pCLElBQU1DLEVBQWNWLFNBQVNXLGNBQWMsT0FDM0NELEVBQVlFLFVBQVVDLElBQUksUUFFdEJMLEdBQ0ZFLEVBQVlFLFVBQVVDLElBQUksUUFHNUJILEVBQVlJLGlCQUFpQixTQUFTLFdBQ2hDVixJQUFjUixJQUNoQkMsRUFBT2pELE9BQU8sQ0FBQzJELEVBQVVFLElBQ3pCTixFQUFnQlAsRUFBbUJNLEdBQy9CTixFQUFrQlQsVUFDcEI0QixNQUFNLFlBR05DLElBR04sSUFFQVgsRUFBYVksWUFBWVAsRUFDM0IsR0FDRixJQUdBTixFQUFVN0IsY0FBY1EsU0FBUSxTQUFDbEMsR0FDL0IsSSxJQUFBK0IsRyxFQUF5QixFLDRDQUFOL0IsSSxvMkJBQVpPLEVBQUd3QixFQUFBLEdBQUV2QixFQUFHdUIsRUFBQSxHQUNLeUIsRUFBYWEsU0FBZSxHQUFOOUQsRUFBV0MsR0FDekN1RCxVQUFVQyxJQUFJLFNBQzVCLEdBQ0YsRUFFTUcsRUFBZSxXQUNKbEIsRUFBU2xELFNBQ3hCdUQsRUFBZ0JuRCxFQUFpQitDLEdBQzdCL0MsRUFBZ0JtQyxXQUNsQjRCLE1BQU0saUJBR1YsRUFHQVosRUFBZ0JuRCxFQUFpQitDLEdBQ2pDSSxFQUFnQlAsRUFBbUJNLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY3JlYXRlUGxheWVyID0gKGVuZW15R2FtZWJvYXJkKSA9PiB7XG4gIGNvbnN0IGF0dGFjayA9IChjb29yZHMpID0+IHtcbiAgICBlbmVteUdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3Jkcyk7XG4gIH07XG5cbiAgcmV0dXJuIHsgYXR0YWNrIH07XG59O1xuXG5jb25zdCBjcmVhdGVDb21wdXRlciA9IChwbGF5ZXJHYW1lYm9hcmQpID0+IHtcbiAgY29uc3QgYXR0YWNrZWRDb29yZHMgPSBbXTtcblxuICBjb25zdCBnZXRSYW5kb21Db29yZHMgPSAoKSA9PiB7XG4gICAgbGV0IHJvdywgY29sO1xuICAgIGRvIHtcbiAgICAgIHJvdyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGNvbCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICB9IHdoaWxlIChcbiAgICAgIGF0dGFja2VkQ29vcmRzLnNvbWUoKGNvb3JkcykgPT4gY29vcmRzWzBdID09PSByb3cgJiYgY29vcmRzWzFdID09PSBjb2wpXG4gICAgKTtcbiAgICByZXR1cm4gW3JvdywgY29sXTtcbiAgfTtcblxuICBjb25zdCBhdHRhY2sgPSAoY29vcmRzKSA9PiB7XG4gICAgaWYgKCFjb29yZHMpIHtcbiAgICAgIGNvb3JkcyA9IGdldFJhbmRvbUNvb3JkcygpO1xuICAgICAgYXR0YWNrZWRDb29yZHMucHVzaChjb29yZHMpO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICBhdHRhY2tlZENvb3Jkcy5zb21lKChjKSA9PiBjWzBdID09PSBjb29yZHNbMF0gJiYgY1sxXSA9PT0gY29vcmRzWzFdKVxuICAgICkge1xuICAgICAgcmV0dXJuOyAvLyBEb24ndCBhdHRhY2sgdGhlIHNhbWUgY29vcmRpbmF0ZSB0d2ljZVxuICAgIH1cbiAgICBwbGF5ZXJHYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZHMpO1xuICAgIHJldHVybiBjb29yZHM7XG4gIH07XG5cbiAgcmV0dXJuIHsgYXR0YWNrIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgY3JlYXRlUGxheWVyLCBjcmVhdGVDb21wdXRlciB9O1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImNvbnN0IGNyZWF0ZUdhbWVib2FyZCA9IChzaGlwc0NvbmZpZykgPT4ge1xuICBjb25zdCBib2FyZCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwIH0sICgpID0+IEFycmF5KDEwKS5maWxsKG51bGwpKTtcbiAgY29uc3QgbWlzc2VkQXR0YWNrcyA9IFtdO1xuICBjb25zdCBzaGlwcyA9IFtdO1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9IChzaGlwLCBjb29yZHMsIG9yaWVudGF0aW9uKSA9PiB7XG4gICAgY29uc3QgW3JvdywgY29sXSA9IGNvb3JkcztcbiAgICBjb25zdCBsZW5ndGggPSBzaGlwLmxlbmd0aDtcblxuICAgIGlmIChcbiAgICAgIHJvdyA8IDAgfHxcbiAgICAgIHJvdyA+PSAxMCB8fFxuICAgICAgY29sIDwgMCB8fFxuICAgICAgY29sID49IDEwIHx8XG4gICAgICAob3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiICYmIGNvbCArIGxlbmd0aCA+IDEwKSB8fFxuICAgICAgKG9yaWVudGF0aW9uID09PSBcInZlcnRpY2FsXCIgJiYgcm93ICsgbGVuZ3RoID4gMTApXG4gICAgKSB7XG4gICAgICAvLyBJbnZhbGlkIHBsYWNlbWVudCwgZG8gbm90IHBsYWNlIHRoZSBzaGlwXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYm9hcmRbcm93XVtjb2wgKyBpXSAhPT0gbnVsbCkge1xuICAgICAgICAgIC8vIFRoZXJlJ3MgYWxyZWFkeSBhIHNoaXAgaW4gdGhpcyBwb3NpdGlvbiwgZG8gbm90IHBsYWNlIHRoZSBzaGlwXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJvYXJkW3Jvd11bY29sICsgaV0gPSBzaGlwO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChib2FyZFtyb3cgKyBpXVtjb2xdICE9PSBudWxsKSB7XG4gICAgICAgICAgLy8gVGhlcmUncyBhbHJlYWR5IGEgc2hpcCBpbiB0aGlzIHBvc2l0aW9uLCBkbyBub3QgcGxhY2UgdGhlIHNoaXBcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYm9hcmRbcm93ICsgaV1bY29sXSA9IHNoaXA7XG4gICAgICB9XG4gICAgfVxuICAgIHNoaXBzLnB1c2goc2hpcCk7XG4gIH07XG5cbiAgc2hpcHNDb25maWcuZm9yRWFjaCgoeyBzaGlwLCBjb29yZHMsIG9yaWVudGF0aW9uIH0pID0+IHtcbiAgICBwbGFjZVNoaXAoc2hpcCwgY29vcmRzLCBvcmllbnRhdGlvbik7XG4gIH0pO1xuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvb3JkcykgPT4ge1xuICAgIGNvbnN0IFtyb3csIGNvbF0gPSBjb29yZHM7XG4gICAgY29uc3Qgc2hpcCA9IGJvYXJkW3Jvd11bY29sXTtcblxuICAgIGlmIChzaGlwKSB7XG4gICAgICBzaGlwLmhpdCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBtaXNzZWRBdHRhY2tzLnB1c2goY29vcmRzKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgYWxsU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gc2hpcHMuZXZlcnkoKHNoaXApID0+IHNoaXAuaXNTdW5rKCkpO1xuICB9O1xuXG4gIHJldHVybiB7IGJvYXJkLCBwbGFjZVNoaXAsIG1pc3NlZEF0dGFja3MsIHJlY2VpdmVBdHRhY2ssIGFsbFN1bmsgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZUdhbWVib2FyZDtcbiIsImZ1bmN0aW9uIGNyZWF0ZVNoaXAobGVuZ3RoKSB7XG4gIHJldHVybiB7XG4gICAgbGVuZ3RoLFxuICAgIGhpdHM6IDAsXG4gICAgaGl0KCkge1xuICAgICAgdGhpcy5oaXRzKys7XG4gICAgfSxcbiAgICBpc1N1bmsoKSB7XG4gICAgICByZXR1cm4gdGhpcy5oaXRzID09PSB0aGlzLmxlbmd0aDtcbiAgICB9LFxuICB9O1xufVxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlU2hpcDtcbiIsImltcG9ydCBjcmVhdGVHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgeyBjcmVhdGVQbGF5ZXIsIGNyZWF0ZUNvbXB1dGVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgY3JlYXRlU2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5cbmNvbnN0IHBsYXllclNoaXBzQ29uZmlnID0gW1xuICB7IHNoaXA6IGNyZWF0ZVNoaXAoNSksIGNvb3JkczogWzAsIDBdLCBvcmllbnRhdGlvbjogXCJob3Jpem9udGFsXCIgfSxcbiAgeyBzaGlwOiBjcmVhdGVTaGlwKDQpLCBjb29yZHM6IFsyLCAzXSwgb3JpZW50YXRpb246IFwidmVydGljYWxcIiB9LFxuICB7IHNoaXA6IGNyZWF0ZVNoaXAoMyksIGNvb3JkczogWzcsIDRdLCBvcmllbnRhdGlvbjogXCJob3Jpem9udGFsXCIgfSxcbiAgeyBzaGlwOiBjcmVhdGVTaGlwKDMpLCBjb29yZHM6IFs0LCAxXSwgb3JpZW50YXRpb246IFwidmVydGljYWxcIiB9LFxuICB7IHNoaXA6IGNyZWF0ZVNoaXAoMiksIGNvb3JkczogWzYsIDZdLCBvcmllbnRhdGlvbjogXCJob3Jpem9udGFsXCIgfSxcbl07XG5cbmNvbnN0IGNvbXB1dGVyU2hpcHNDb25maWcgPSBbXG4gIHsgc2hpcDogY3JlYXRlU2hpcCg1KSwgY29vcmRzOiBbMCwgMF0sIG9yaWVudGF0aW9uOiBcImhvcml6b250YWxcIiB9LFxuICB7IHNoaXA6IGNyZWF0ZVNoaXAoNCksIGNvb3JkczogWzIsIDNdLCBvcmllbnRhdGlvbjogXCJ2ZXJ0aWNhbFwiIH0sXG4gIHsgc2hpcDogY3JlYXRlU2hpcCgzKSwgY29vcmRzOiBbNiwgNl0sIG9yaWVudGF0aW9uOiBcImhvcml6b250YWxcIiB9LFxuICB7IHNoaXA6IGNyZWF0ZVNoaXAoMyksIGNvb3JkczogWzgsIDFdLCBvcmllbnRhdGlvbjogXCJob3Jpem9udGFsXCIgfSxcbiAgeyBzaGlwOiBjcmVhdGVTaGlwKDIpLCBjb29yZHM6IFs3LCA0XSwgb3JpZW50YXRpb246IFwiaG9yaXpvbnRhbFwiIH0sXG5dO1xuXG4vLyBDcmVhdGUgZ2FtZWJvYXJkcyB3aXRoIHByZWRldGVybWluZWQgc2hpcCBjb25maWd1cmF0aW9uc1xuY29uc3QgcGxheWVyR2FtZWJvYXJkID0gY3JlYXRlR2FtZWJvYXJkKHBsYXllclNoaXBzQ29uZmlnKTtcbmNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkID0gY3JlYXRlR2FtZWJvYXJkKGNvbXB1dGVyU2hpcHNDb25maWcpO1xuY29uc3QgcGxheWVyID0gY3JlYXRlUGxheWVyKGNvbXB1dGVyR2FtZWJvYXJkKTtcbmNvbnN0IGNvbXB1dGVyID0gY3JlYXRlQ29tcHV0ZXIocGxheWVyR2FtZWJvYXJkKTtcblxuY29uc3QgcGxheWVyQm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllci1ib2FyZFwiKTtcbmNvbnN0IGNvbXB1dGVyQm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbXB1dGVyLWJvYXJkXCIpO1xuXG5jb25zdCByZW5kZXJHYW1lYm9hcmQgPSAoZ2FtZWJvYXJkLCBib2FyZEVsZW1lbnQpID0+IHtcbiAgLy8gQ2xlYXIgdGhlIGJvYXJkIGVsZW1lbnRcbiAgYm9hcmRFbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XG5cbiAgLy8gUmVuZGVyIHRoZSBnYW1lYm9hcmQgb24gdGhlIGJvYXJkIGVsZW1lbnRcbiAgZ2FtZWJvYXJkLmJvYXJkLmZvckVhY2goKHJvdywgcm93SW5kZXgpID0+IHtcbiAgICByb3cuZm9yRWFjaCgoY2VsbCwgY29sSW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGNlbGxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIGNlbGxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJjZWxsXCIpO1xuXG4gICAgICBpZiAoY2VsbCkge1xuICAgICAgICBjZWxsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwic2hpcFwiKTtcbiAgICAgIH1cblxuICAgICAgY2VsbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgaWYgKGdhbWVib2FyZCA9PT0gY29tcHV0ZXJHYW1lYm9hcmQpIHtcbiAgICAgICAgICBwbGF5ZXIuYXR0YWNrKFtyb3dJbmRleCwgY29sSW5kZXhdKTtcbiAgICAgICAgICByZW5kZXJHYW1lYm9hcmQoY29tcHV0ZXJHYW1lYm9hcmQsIGNvbXB1dGVyQm9hcmQpO1xuICAgICAgICAgIGlmIChjb21wdXRlckdhbWVib2FyZC5hbGxTdW5rKCkpIHtcbiAgICAgICAgICAgIGFsZXJ0KFwiWW91IHdpbiFcIik7XG4gICAgICAgICAgICAvLyBSZXNldCB0aGUgZ2FtZSBvciBkaXNwbGF5IGEgcmVzdGFydCBidXR0b25cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29tcHV0ZXJUdXJuKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKGNlbGxFbGVtZW50KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gUmVuZGVyIG1pc3NlZCBhdHRhY2tzXG4gIGdhbWVib2FyZC5taXNzZWRBdHRhY2tzLmZvckVhY2goKGNvb3JkcykgPT4ge1xuICAgIGNvbnN0IFtyb3csIGNvbF0gPSBjb29yZHM7XG4gICAgY29uc3QgY2VsbEVsZW1lbnQgPSBib2FyZEVsZW1lbnQuY2hpbGRyZW5bcm93ICogMTAgKyBjb2xdO1xuICAgIGNlbGxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtaXNzZWRcIik7XG4gIH0pO1xufTtcblxuY29uc3QgY29tcHV0ZXJUdXJuID0gKCkgPT4ge1xuICBjb25zdCBjb29yZHMgPSBjb21wdXRlci5hdHRhY2soKTtcbiAgcmVuZGVyR2FtZWJvYXJkKHBsYXllckdhbWVib2FyZCwgcGxheWVyQm9hcmQpO1xuICBpZiAocGxheWVyR2FtZWJvYXJkLmFsbFN1bmsoKSkge1xuICAgIGFsZXJ0KFwiQ29tcHV0ZXIgd2lucyFcIik7XG4gICAgLy8gUmVzZXQgdGhlIGdhbWUgb3IgZGlzcGxheSBhIHJlc3RhcnQgYnV0dG9uXG4gIH1cbn07XG5cbi8vIFJlbmRlciBnYW1lYm9hcmRzXG5yZW5kZXJHYW1lYm9hcmQocGxheWVyR2FtZWJvYXJkLCBwbGF5ZXJCb2FyZCk7XG5yZW5kZXJHYW1lYm9hcmQoY29tcHV0ZXJHYW1lYm9hcmQsIGNvbXB1dGVyQm9hcmQpO1xuIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjcmVhdGVQbGF5ZXIiLCJlbmVteUdhbWVib2FyZCIsImF0dGFjayIsImNvb3JkcyIsInJlY2VpdmVBdHRhY2siLCJjcmVhdGVDb21wdXRlciIsInBsYXllckdhbWVib2FyZCIsImF0dGFja2VkQ29vcmRzIiwic29tZSIsImMiLCJyb3ciLCJjb2wiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJnZXRSYW5kb21Db29yZHMiLCJwdXNoIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInNoaXBzQ29uZmlnIiwiYm9hcmQiLCJBcnJheSIsImZyb20iLCJsZW5ndGgiLCJmaWxsIiwibWlzc2VkQXR0YWNrcyIsInNoaXBzIiwicGxhY2VTaGlwIiwic2hpcCIsIm9yaWVudGF0aW9uIiwiX2Nvb3JkcyIsIl9zbGljZWRUb0FycmF5IiwiaSIsImZvckVhY2giLCJfcmVmIiwiX2Nvb3JkczIiLCJoaXQiLCJhbGxTdW5rIiwiZXZlcnkiLCJpc1N1bmsiLCJoaXRzIiwidGhpcyIsInBsYXllclNoaXBzQ29uZmlnIiwiY3JlYXRlU2hpcCIsImNvbXB1dGVyU2hpcHNDb25maWciLCJjcmVhdGVHYW1lYm9hcmQiLCJjb21wdXRlckdhbWVib2FyZCIsInBsYXllciIsImNvbXB1dGVyIiwicGxheWVyQm9hcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29tcHV0ZXJCb2FyZCIsInJlbmRlckdhbWVib2FyZCIsImdhbWVib2FyZCIsImJvYXJkRWxlbWVudCIsImlubmVySFRNTCIsInJvd0luZGV4IiwiY2VsbCIsImNvbEluZGV4IiwiY2VsbEVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFsZXJ0IiwiY29tcHV0ZXJUdXJuIiwiYXBwZW5kQ2hpbGQiLCJjaGlsZHJlbiJdLCJzb3VyY2VSb290IjoiIn0=